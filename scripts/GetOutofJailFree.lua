INPUT_COMBO = 0x0301

function _OnFrame()
    if ReadByte(0x1A8D6B) == 0xCC and ReadString(0x9A9830, 0x04) == 'KH2J' then
        WriteArray(0x1A8D6B, { 0x66, 0x8B, 0x2D, 0x7E, 0xA4, 0xA4, 0x00 }) -- mov bp, [0xBF31F0]
        WriteArray(0x1A8D72, { 0x66, 0x81, 0xFD, INPUT_COMBO, (INPUT_COMBO >> 8) }) -- cmp bp, 0x0309
        WriteArray(0x1A8D77, { 0x74, 0x94, 0xC3 }) -- je 0x1A8D0D / ret

        WriteArray(0x1A8D0D, { 0x48, 0x8D, 0x0D, 0xEC, 0x72, 0x68, 0x00 }) -- lea rcx, [0x830000] 
        WriteArray(0x1A8D14, { 0x49, 0x8B, 0xD4 }) -- mov rdx, rax
        WriteArray(0x1A8D17, { 0x4D, 0x8B, 0xC4 }) -- mov r8, r12
        WriteArray(0x1A8D1A, { 0x4D, 0x8B, 0xCC }) -- mov r9, r12
        WriteArray(0x1A8D1D, { 0xEB, 0x9A }) -- jmp 0x1A8CB9

        WriteArray(0x1A8CB9, { 0xE9, 0x15, 0xFF, 0xFF, 0xFF }) -- jmp 0x1A8BD3
        
        WriteArray(0x1A8BD3, { 0x4C, 0x89, 0x25, 0x16, 0xA6, 0xA4, 0x00 }) -- mov [0xBF31F0], r12
        WriteArray(0x1A8BDA, { 0xE9, 0x71, 0x9A, 0xFA, 0xFF, 0xC3 }) -- jmp 0x152650 / ret

        WriteArray(0x181374, { 0xE9, 0xF2, 0x79, 0x02, 0x00 } ) -- jmp 0x1A8D6B

        ConsolePrint("Get Out of Jail Free! - Initialized! | STEAM 1.0.0.9!")
    elseif ReadByte(0x1A83BD) == 0xCC and ReadString(0x9A92F0, 0x04) == 'KH2J' then
        WriteArray(0x1A83BD, { 0x66, 0x8B, 0x2D, 0x3C, 0x2A, 0x85, 0x02 }) -- mov bp, [0x29FAE00]
        WriteArray(0x1A83C4, { 0x66, 0x81, 0xFD, INPUT_COMBO, (INPUT_COMBO >> 8) }) -- cmp bp, 0x0309
        WriteArray(0x1A83C9, { 0x74, 0x50, 0xC3 }) -- je 0x1A841B / ret

        WriteArray(0x1A841B, { 0x48, 0x8D, 0x0D, 0xDE, 0x7B, 0x68, 0x00 }) -- lea rcx, [0x830000] 
        WriteArray(0x1A8422, { 0x49, 0x8B, 0xD4 }) -- mov rdx, r12
        WriteArray(0x1A8425, { 0x4D, 0x8B, 0xC4 }) -- mov r8, r12
        WriteArray(0x1A8428, { 0x4D, 0x8B, 0xCC }) -- mov r9, r12
        WriteArray(0x1A842B, { 0xE9, 0x53, 0xFE, 0xFF, 0xFF }) -- jmp 0x1A8283
        
        WriteArray(0x1A8283, { 0x4C, 0x89, 0x25, 0x76, 0x2B, 0x85, 0x02 }) -- mov [0x29FAE00], r12
        WriteArray(0x1A828A, { 0xE9, 0x71, 0x9A, 0xFA, 0xFF, 0xC3 }) -- jmp 0x151D00 / ret

        WriteArray(0x180A24, { 0xE9, 0x94, 0x79, 0x02, 0x00 } ) -- jmp 0x1A83BD

        ConsolePrint("Get Out of Jail Free! - Initialized! | EPIC 1.0.0.9!")
    end

    WriteArray(0x830000, { 0x04, 0x1A, 0x32, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00 })
end